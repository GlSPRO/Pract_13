{% load static %}
<!doctype html>
<html lang="ru">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>{% block title %}Арт Кулинария · HR{% endblock %}</title>
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
    <link href="{% static 'css/theme.css' %}" rel="stylesheet">
    {% block extra_css %}{% endblock %}
</head>
<body class="{% block body_class %}{% endblock %}">
{% if not hide_shell %}
    <div class="app-shell">
        <aside class="sidebar" id="sidebar">
            <div class="brand">
                <div class="avatar bg-light text-dark fw-bold rounded-circle d-flex align-items-center justify-content-center" style="width:40px;height:40px;">AK</div>
                <div>
                    <div>Арт Кулинария</div>
                    <span>HR портал</span>
                </div>
            </div>
            <div class="nav-section">
                <div class="nav-label">Навигация</div>
                <ul class="nav-list">
                    {% if portal_type == "hr" %}
                        <li><a class="nav-link {% if active_section == 'dashboard' %}active{% endif %}" href="{% url 'hr_portal:dashboard' %}">
                            <span class="indicator"></span><i class="bi bi-graph-up"></i> Дашборд HR</a></li>
                        <li><a class="nav-link {% if active_section == 'employees' %}active{% endif %}" href="{% url 'hr_portal:employees' %}">
                            <span class="indicator"></span><i class="bi bi-people"></i> Сотрудники</a></li>
                        <li><a class="nav-link {% if active_section == 'qualification' %}active{% endif %}" href="{% url 'hr_portal:qualification_control' %}">
                            <span class="indicator"></span><i class="bi bi-mortarboard"></i> Квалификация</a></li>
                        <li><a class="nav-link {% if active_section == 'requests_profile' %}active{% endif %}" href="{% url 'hr_portal:profile_requests' %}">
                            <span class="indicator"></span><i class="bi bi-person-lines-fill"></i> Заявки профиля</a></li>
                        <li><a class="nav-link {% if active_section == 'requests_leave' %}active{% endif %}" href="{% url 'hr_portal:leave_requests' %}">
                            <span class="indicator"></span><i class="bi bi-file-earmark-medical"></i> Отпуска/больничные</a></li>
                        <li><a class="nav-link {% if active_section == 'tasks_control' %}active{% endif %}" href="{% url 'hr_portal:task_control' %}">
                            <span class="indicator"></span><i class="bi bi-list-check"></i> Контроль задач</a></li>
                        <li><a class="nav-link {% if active_section == 'interviews' %}active{% endif %}" href="{% url 'hr_portal:interviews' %}">
                            <span class="indicator"></span><i class="bi bi-person-video3"></i> Собеседования</a></li>
                        <li><a class="nav-link {% if active_section == 'schedule' %}active{% endif %}" href="{% url 'hr_portal:schedule' %}">
                            <span class="indicator"></span><i class="bi bi-calendar3"></i> График смен</a></li>
                    {% elif portal_type == "employee" %}
                        <li><a class="nav-link {% if active_section == 'dashboard' %}active{% endif %}" href="{% url 'core:employee_dashboard' %}">
                            <span class="indicator"></span><i class="bi bi-person-badge"></i> Кабинет</a></li>
                        <li><a class="nav-link {% if active_section == 'profile' %}active{% endif %}" href="{% url 'core:employee_profile' %}">
                            <span class="indicator"></span><i class="bi bi-person-vcard"></i> Профиль и стаж</a></li>
                        <li><a class="nav-link {% if active_section == 'schedule' %}active{% endif %}" href="{% url 'core:employee_schedule' %}">
                            <span class="indicator"></span><i class="bi bi-calendar-week"></i> График смен</a></li>
                        <li><a class="nav-link {% if active_section == 'qualification' %}active{% endif %}" href="{% url 'core:employee_qualification' %}">
                            <span class="indicator"></span><i class="bi bi-patch-check"></i> Квалификация</a></li>
                        <li><a class="nav-link {% if active_section == 'leave' %}active{% endif %}" href="{% url 'core:employee_leave' %}">
                            <span class="indicator"></span><i class="bi bi-file-medical"></i> Больничные/отпуска</a></li>
                        <li><a class="nav-link {% if active_section == 'tasks' %}active{% endif %}" href="{% url 'core:employee_tasks' %}">
                            <span class="indicator"></span><i class="bi bi-list-task"></i> Задачи</a></li>
                    {% else %}
                        <li><a class="nav-link {% if active_section == 'dashboard' %}active{% endif %}" href="{% url 'admin_portal:dashboard' %}">
                            <span class="indicator"></span><i class="bi bi-graph-up"></i> Дашборд</a></li>
                        <li><a class="nav-link {% if active_section == 'users' %}active{% endif %}" href="{% url 'admin_portal:users_list' %}">
                            <span class="indicator"></span><i class="bi bi-people"></i> Пользователи</a></li>
                        <li><a class="nav-link {% if active_section == 'audit' %}active{% endif %}" href="{% url 'admin_portal:audit' %}">
                            <span class="indicator"></span><i class="bi bi-clipboard-check"></i> Аудит</a></li>
                        <li><a class="nav-link {% if active_section == 'interviews' %}active{% endif %}" href="{% url 'admin_portal:interview_approvals' %}">
                            <span class="indicator"></span><i class="bi bi-person-check"></i> Подтверждения</a></li>
                    {% endif %}
                </ul>
            </div>
            <div class="footer">
                v0.1 · прототип интерфейса
            </div>
        </aside>
        <main class="app-main">
            <header class="topbar">
                <div class="left">
                    <button class="sidebar-toggle" id="sidebarToggle" aria-label="Открыть меню">
                        <i class="bi bi-list"></i>
                    </button>
                    <div class="fw-semibold text-muted">
                        {% if portal_type == "hr" %}
                            HR-портал · ООО «Арт Кулинария»
                        {% elif portal_type == "employee" %}
                            Кабинет сотрудника · ООО «Арт Кулинария»
                        {% else %}
                            Админ-портал · ООО «Арт Кулинария»
                        {% endif %}
                    </div>
                </div>
                <div class="d-flex align-items-center gap-3">
                    {% if request.user.is_authenticated %}
                        <span class="user-pill">
                            <i class="bi bi-person-circle"></i>
                            {{ request.user.get_full_name|default:request.user.username|default:"Пользователь" }}
                        </span>
                        <a class="btn btn-outline-secondary btn-sm" href="{% url 'core:logout' %}">Выход</a>
                    {% else %}
                        <a class="btn btn-primary btn-sm" href="{% url 'core:login' %}">Войти</a>
                    {% endif %}
                </div>
            </header>
            <div class="page-body container-fluid">
                {% include 'includes/messages.html' %}
                {% block content %}{% endblock %}
            </div>
        </main>
    </div>
{% else %}
    <div class="auth-wrapper">
        {% include 'includes/messages.html' %}
        {% block auth_content %}{% endblock %}
    </div>
{% endif %}

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script>
    const toggle = document.getElementById('sidebarToggle');
    const sidebar = document.getElementById('sidebar');
    if (toggle && sidebar) {
        toggle.addEventListener('click', () => sidebar.classList.toggle('open'));
    }
</script>
{% block extra_js %}{% endblock %}
</body>
</html>
